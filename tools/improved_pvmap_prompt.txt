You are an expert Data Commons engineer. Generate a Property-Value (PV) map that transforms input data into Data Commons format.

# HOW THE PROCESSOR WORKS

The processor converts each data cell into a StatVarObservation by collecting PVs from:
1. **Column Header** → collects those PVs
2. **Cell Value** → collects those PVs
3. **Row Header** → collects those PVs
4. **Merge** → all PVs form the complete observation

**Key Insight**: Column header properties apply to ALL cells in that column.

## Required Properties

**StatVarObservation**: `value`, `observationDate`, `observationAbout`, `observationPeriod`, `unit`, `measurementMethod`, `scalingFactor`

**StatVar**: `populationType`, `measuredProperty`, `statType` + constraints (age, gender, race, etc.)

**NEVER map `variableMeasured`** - auto-constructed by processor.

---

# PV MAP FORMAT

`key,property1,value1,property2,value2,...`

- Keys must **exactly match** column headers or cell values (case-sensitive)
- Use `COLUMN:VALUE` syntax for values in specific columns (e.g., `place:Alabama`)
- Quote keys containing commas/special chars: `"ICD-10:#Heart (I00-I51)",causeOfDeath,X`

---

# COMPREHENSIVE EXAMPLE

**Input Data:**
```csv
Country or Area,Year,Sex,Value
Åland Islands,2023,Both Sexes,11785
Åland Islands,2023,Male,5630
Åland Islands,2023,Female,6155
United States,2023,Both Sexes,331000000
```

**PVMAP:**
```csv
key,prop,value,p2,v2,p3,v3,p4,v4
Country or Area:Åland Islands,observationAbout,country/AX
Country or Area:United States,observationAbout,country/USA
Year,observationDate,{Data}
Value,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
Both Sexes,gender,
Male,gender,Male
Female,gender,Female
```

**Why this works:**
- Place names → explicit DCID mappings (dynamic `{Data}` won't resolve names)
- `Value` column has ALL StatVar properties (`populationType`, `measuredProperty`, `statType`)
- `Both Sexes` → empty gender (no constraint = total)
- Cell values (`Male`, `Female`) map to constraints

---

# DATA PATTERNS

## Pattern A: Flat Data (one observation per row)
```csv
REF_AREA,#Regex,"^(?P<Code>[A-Z]+):.*",observationAbout,country/{Code}
TIME_PERIOD,observationDate,{Data}
OBS_VALUE,value,{Number},populationType,FinancialInstrument,measuredProperty,interestRate,statType,measuredValue
M: Monthly,observationPeriod,P1M
```

## Pattern B: Wide Data (multiple value columns)

⚠️ **CRITICAL**: Each column MUST include ALL properties - no inheritance between columns.

```csv
Jan 2015,observationDate,2015-01,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue,observationAbout,country/USA
Feb 2015,observationDate,2015-02,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue,observationAbout,country/USA
```

**WRONG** (missing StatVar properties):
```csv
Jan 2015,observationDate,2015-01,value,{Number}
```

## Pattern C: Row+Column Combinations
```csv
place,measurementMethod,CensusSurvey
year,observationDate,{Data}
Male,gender,Male,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
Female,gender,Female,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
place:Alabama,observationAbout,geoId/01
```

## Pattern D: Series ID Multiplexing (BLS-style)
```csv
Series ID,#ignore,skip
Series ID:CEU0000000001,populationType,BLSWorker,measuredProperty,count,naics,NAICS/10,name,"All Employees"
Jan 2015,observationDate,2015-01,value,{Number},observationPeriod,P1M,observationAbout,country/USA,populationType,BLSWorker,measuredProperty,count,statType,measuredValue
```

---

# SPECIAL SYNTAX

## Placeholders
- `{Data}` - Raw string value from cell
- `{Number}` - Numeric value from cell
- `{Key}` - The key string that was looked up

## Intermediate Variables
Capitalize to capture for later use (not included in StatVar):
```csv
year_col,Year,{Number}
month_col,#Regex,"M(?P<Month>[0-9]+)"
value_col,observationDate,{Year}-{Month},value,{Number}
```

## #Format - Zero-pad Values
```csv
FIPS,#Format,"observationAbout=geoId/{Number:05d}"        # 1001 → geoId/01001
state_fips,#Format,"observationAbout=geoId/{Number:02d}"  # 6 → geoId/06
```

## #Regex - Extract with Named Groups
```csv
REF_AREA,#Regex,"^(?P<Code>[A-Z]+):.*",observationAbout,country/{Code}
```
**Must use named groups** `(?P<Name>...)` - unnamed groups don't work.

## #Eval - Python Expressions
```csv
Status,#Eval,"active='Yes' if '{Data}' == 'Y' else 'No'"
```
**Always quote {Data}** in expressions.

## #ignore - Drop Rows
```csv
Series ID,#ignore,skip
```
Drops entire row containing this value. To skip value only, use empty intermediate: `BadValue,Skip,''`

---

# PLACE FORMATS

| Format | Example | Use Case |
|--------|---------|----------|
| `country/{Data}` | `country/USA` | ISO-3 codes in data |
| `geoId/{Number:02d}` | `geoId/06` | US state FIPS |
| `geoId/{Number:05d}` | `geoId/01001` | US county FIPS |
| `wikidataId/QXXXXX` | `wikidataId/Q22424` | Non-US places |
| `Earth` | `Earth` | Global data |

⚠️ **Dynamic construction does NOT work**: `observationAbout,{Country}/{City}` fails.

**Use explicit mappings for place names:**
```csv
Country or Area:Åland Islands,observationAbout,country/AX
srcStateName:Punjab,observationAbout,wikidataId/Q22424
```

## Composite FIPS (state + county)
```csv
statefips,StateFips,{Data}
countyfips,#Format,"observationAbout=geoId/{StateFips}{Number:03d}"
```

---

# CRITICAL RULES

1. **Keys must exactly match** input data (case-sensitive)
2. **Quote keys with special chars**: commas, parentheses, quotes
3. **Every value column needs ALL properties**: `value,{Number}`, `populationType`, `measuredProperty`, `statType`
4. **>5-10 categorical values?** Use explicit mappings, not regex
5. **Place names require explicit DCID mappings** - no dynamic resolution

---

# KNOWN LIMITATIONS (require preprocessing)

- Carry-forward/sparse data (values not repeated per row)
- Multi-row headers / merged cells
- Footer/metadata rows after blank lines
- ISO-2 country codes (need conversion to ISO-3)

Non-numeric placeholders (`#`, `*`, `N/A`, `Unreliable`) are auto-skipped.

---

# COMMON MISTAKES

1. Missing StatVar properties on value columns
2. Partial key matches (`AR` won't match `AR: Argentina`)
3. Wide data without complete properties per column
4. Dynamic place construction instead of explicit mappings
5. Single regex for 50+ codes instead of explicit list
6. Ignoring column then referencing it (`#ignore` + `{Year}`)

---

# SCHEMA EXAMPLES

{{SCHEMA_EXAMPLES}}

---

# INPUT DATA

{{SAMPLED_DATA}}

---

# PROCESSOR CONFIG

{{METADATA_CONFIG}}

---

# OUTPUT

Provide ONLY pvmap.csv content in a csv code block.

**CHECKLIST:**
- [ ] Keys exactly match input (case-sensitive)
- [ ] Special char keys are double-quoted
- [ ] **Every value column** has: `value,{Number}`, `populationType`, `measuredProperty`, `statType`
- [ ] `observationDate` format: YYYY, YYYY-MM, or YYYY-MM-DD
- [ ] `observationAbout` uses valid DCID (geoId/, country/, wikidataId/, Earth)
- [ ] No dynamic place construction - explicit mappings only
- [ ] #Regex uses named groups `(?P<Name>...)`
- [ ] Note any data limitations in response
