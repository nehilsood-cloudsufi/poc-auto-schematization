You are an expert Data Commons engineer. Generate a Property-Value (PV) map that transforms input data into Data Commons format.

# HOW THE PROCESSOR WORKS

The processor converts each data cell into a StatVarObservation by collecting PVs from:
1. **Column Header** → collects those PVs
2. **Cell Value** → collects those PVs
3. **Row Header** → collects those PVs
4. **Merge** → all PVs form the complete observation

**Key Insight**: Column header properties apply to ALL cells in that column.

## CRITICAL: Detect Pre-Formatted Data Commons Data

**Before generating PVMAP, check if data is ALREADY in Data Commons format:**

### Detection Criteria:
1. **Has `variableMeasured` column** with DCID values like:
   - `dcid:Count_Person_Female`
   - `dcid:CumulativeCount_FoodBasket_Delivered`
   - `dcid:InterestRate_TreasuryBill_3Month_Primary`

2. **Has `observationAbout` column** with place/entity DCIDs:
   - `country/USA`, `geoId/06`, `wikidataId/Q391149`

3. **Has `observationDate` column** with standard formats:
   - `YYYY`, `YYYY-MM`, `YYYY-MM-DD`

4. **Has `value` column** with numeric measurements

### If Pre-Formatted → Use Passthrough Mapping:

```csv
observationAbout,observationAbout,{Data}
observationDate,observationDate,{Data}
variableMeasured,variableMeasured,{Data}
value,value,{Number}
```

**DO NOT:**
- ❌ Try to construct new `variableMeasured` entries
- ❌ Parse or deconstruct existing DCIDs
- ❌ Add `populationType`, `measuredProperty`, `statType` to columns that already have `variableMeasured`

**Example Pre-Formatted Data:**
```csv
observationAbout,observationDate,variableMeasured,value
country/BRA,2020-01,dcid:CumulativeCount_FoodBasket_Delivered,1500
```

**Correct PVMAP:**
```csv
key,property,value
observationAbout,observationAbout,{Data}
observationDate,observationDate,{Data}
variableMeasured,variableMeasured,{Data}
value,value,{Number}
```

### CRITICAL: When NOT to Use Passthrough

Even if columns are named `variableMeasured`, `observationAbout`, etc., do NOT use passthrough if:

1. **variableMeasured contains descriptive text, not DCIDs**:
   - ❌ Passthrough wrong: `variableMeasured` has values like "Food baskets delivered", "Gypsy families receiving baskets"
   - ✅ Passthrough correct: `variableMeasured` has values like `dcid:Count_FoodBasket_Delivered`, `dcid:Count_Person_Female`

2. **Data requires semantic decomposition**:
   - Multiple measurement types need different StatVar properties
   - Categorical dimensions need constraint properties (foodBasketStatus, benefitType, etc.)

3. **Data has domain-specific properties not captured by passthrough**:
   - Food basket data needs: `foodBasketStatus`, `measurementDenominator`
   - Benefit programs need: `benefitProgram`, `benefitType`
   - Employment data needs: `gender`, `age` constraints

**Rule**: Passthrough is ONLY for data where `variableMeasured` already contains valid `dcid:` prefixed DCIDs that fully describe the StatVar.

---

## Required Properties

**StatVarObservation**: `value`, `observationDate`, `observationAbout`, `observationPeriod`, `unit`, `measurementMethod`, `scalingFactor`

**StatVar**: `populationType`, `measuredProperty`, `statType` + constraints (age, gender, race, etc.)

**NEVER map `variableMeasured`** - auto-constructed by processor.

---

# PV MAP FORMAT

`key,property1,value1,property2,value2,...`

- Keys must **exactly match** column headers or cell values (case-sensitive)
- Use `COLUMN:VALUE` syntax for values in specific columns (e.g., `place:Alabama`)
- Quote keys containing commas/special chars: `"ICD-10:#Heart (I00-I51)",causeOfDeath,X`

## CSV Escaping Rules

**Critical**: Output must be valid CSV parseable by Python's csv.reader:

1. **Backslashes must be escaped**: Use `\\` for literal backslash
   - ❌ Wrong: `"Doctor's\1\"`
   - ✅ Correct: `"Doctor's\\1"` or avoid backslashes entirely

2. **Quotes inside quoted fields**: Use double quotes `""`
   - ❌ Wrong: `"She said "hi""`
   - ✅ Correct: `"She said ""hi"""`

3. **Commas in keys**: Must double-quote the entire key
   - ✅ Correct: `"ICD-10:#Heart (I00-I51)",causeOfDeath,HeartDisease`

4. **Special characters to avoid**: `\`, unmatched quotes, newlines in keys

**Validation**: After generating PVMAP, ensure each line has:
- Proper comma separation
- Balanced quotes
- No trailing commas (unless intended empty values)

---

# COMPREHENSIVE EXAMPLE

**Input Data:**
```csv
Country or Area,Year,Sex,Value
Åland Islands,2023,Both Sexes,11785
Åland Islands,2023,Male,5630
Åland Islands,2023,Female,6155
United States,2023,Both Sexes,331000000
```

**PVMAP:**
```csv
key,prop,value,p2,v2,p3,v3,p4,v4
Country or Area:Åland Islands,observationAbout,country/AX
Country or Area:United States,observationAbout,country/USA
Year,observationDate,{Data}
Value,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
Both Sexes,gender,
Male,gender,Male
Female,gender,Female
```

**Why this works:**
- Place names → explicit DCID mappings (dynamic `{Data}` won't resolve names)
- `Value` column has ALL StatVar properties (`populationType`, `measuredProperty`, `statType`)
- `Both Sexes` → empty gender (no constraint = total)
- Cell values (`Male`, `Female`) map to constraints

---

# DATA PATTERNS

## Pattern A: Flat Data (one observation per row)
```csv
REF_AREA,#Regex,"^(?P<Code>[A-Z]+):.*",observationAbout,country/{Code}
TIME_PERIOD,observationDate,{Data}
OBS_VALUE,value,{Number},populationType,FinancialInstrument,measuredProperty,interestRate,statType,measuredValue
M: Monthly,observationPeriod,P1M
```

## Pattern B: Wide Data (multiple value columns)

⚠️ **CRITICAL**: Each column MUST include ALL properties - no inheritance between columns.

```csv
Jan 2015,observationDate,2015-01,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue,observationAbout,country/USA
Feb 2015,observationDate,2015-02,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue,observationAbout,country/USA
```

**WRONG** (missing StatVar properties):
```csv
Jan 2015,observationDate,2015-01,value,{Number}
```

## Pattern C: Row+Column Combinations
```csv
place,measurementMethod,CensusSurvey
year,observationDate,{Data}
Male,gender,Male,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
Female,gender,Female,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
place:Alabama,observationAbout,geoId/01
```

## Pattern D: Dimension Properties (Categorical Constraints)

When data has categorical columns that constrain the StatVar (age, gender, race, education, etc.), map them as constraint properties:

```csv
# Core observation properties
Country,observationAbout,country/{Data}
Year,observationDate,{Data}
Value,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue

# Dimension constraints (map each category value)
gender:Male,gender,Male
gender:Female,gender,Female
gender:All,gender,
age:0-17,age,Years0To17
age:18-64,age,Years18To64
age:65+,age,Years65Onwards
race:White,race,WhiteAlone
race:Black,race,BlackOrAfricanAmericanAlone
```

**CRITICAL**: Dimension columns constrain the StatVar. They are NOT separate observation properties.

**When to use dimension properties:**
- Column represents a categorical attribute of the population being measured
- Values split the same measurement across different demographic groups
- Examples: age, gender, race, ethnicity, educationalAttainment, employmentStatus, disability, citizenship

**Wrong approach** (treating dimension as observation property):
```csv
# ❌ DON'T DO THIS
Value,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue,gender,Male
```

**Correct approach** (dimension as constraint):
```csv
# ✅ DO THIS
Value,value,{Number},populationType,Person,measuredProperty,count,statType,measuredValue
gender:Male,gender,Male
gender:Female,gender,Female
```

## Pattern E: Series ID Multiplexing (BLS-style)
```csv
Series ID,#ignore,skip
Series ID:CEU0000000001,populationType,BLSWorker,measuredProperty,count,naics,NAICS/10,name,"All Employees"
Jan 2015,observationDate,2015-01,value,{Number},observationPeriod,P1M,observationAbout,country/USA,populationType,BLSWorker,measuredProperty,count,statType,measuredValue
```

## Pattern F: Wide Data with Multi-Dimensional Column Names

When columns encode multiple dimensions in their names (common in government/education datasets), each column needs a complete property mapping.

**Recognition Signals:**
- Column names contain abbreviations/codes (M/F for gender, AME/ASI/BLA for race)
- Many similar columns with varying codes (50+ columns with pattern)
- Column name encodes 3+ dimensions

**Example (Education harassment/bullying data):**
```csv
# Column naming pattern: {Gender}_{Race}_{Version}_{Action}_{Type}_{Bias}
# M_AME_5_DISC_HAR_DIS = Male + AmericanIndian + v5 + Disciplined + Harassment + Disability

COMBOKEY,#Format,observationAbout=nces/{Data:0>12},populationType,Student,measuredProperty,count
Year,observationDate,{Number}

# Each value column maps ALL its encoded dimensions:
M_AME_5_DISC_HAR_DIS,crimeType,HarassmentOrBullying,disciplinaryAction,SuspendedOrExpelled,gender,Male,biasMotivation,Disability,offenderRace,AmericanIndianOrAlaskaNativeAlone,value,{Number}
M_ASI_5_DISC_HAR_DIS,crimeType,HarassmentOrBullying,disciplinaryAction,SuspendedOrExpelled,gender,Male,biasMotivation,Disability,offenderRace,AsianOrPacificIslander,value,{Number}
M_BLA_5_DISC_HAR_DIS,crimeType,HarassmentOrBullying,disciplinaryAction,SuspendedOrExpelled,gender,Male,biasMotivation,Disability,offenderRace,Black,value,{Number}
F_AME_5_DISC_HAR_SEX,crimeType,HarassmentOrBullying,disciplinaryAction,SuspendedOrExpelled,gender,Female,biasMotivation,Gender,offenderRace,AmericanIndianOrAlaskaNativeAlone,value,{Number}
# ... continue for ALL columns (may be 100+ mappings)
```

**CRITICAL**: You MUST create a separate mapping row for EACH value column. Do NOT try to use a single regex or generic mapping. Even if there are 300+ columns, map each one explicitly.

## Pattern G: Composite Date Construction (Year + Month)

When dates are split across columns or rows (Year and Month separately), use intermediate variables to construct the full date.

**Recognition Signals:**
- Columns named "Jan", "Feb", etc. or "Jan 2020", "Feb 2020"
- Separate Year row or column
- Monthly/quarterly time series data

**Example (BLS CPI data):**
```csv
key,prop,val,p1,v1,p2,v2
# First, map month names to numeric values and define date template
Jan.,Month,01,observationDate,{Year}-{Month}
Feb.,Month,02,observationDate,{Year}-{Month}
Mar.,Month,03,observationDate,{Year}-{Month}
Apr.,Month,04,observationDate,{Year}-{Month}
May.,Month,05,observationDate,{Year}-{Month}
Jun.,Month,06,observationDate,{Year}-{Month}
Jul.,Month,07,observationDate,{Year}-{Month}
Aug.,Month,08,observationDate,{Year}-{Month}
Sep.,Month,09,observationDate,{Year}-{Month}
Oct.,Month,10,observationDate,{Year}-{Month}
Nov.,Month,11,observationDate,{Year}-{Month}
Dec.,Month,12,observationDate,{Year}-{Month}

# Then map year values
2020,Year,2020
2021,Year,2021
2022,Year,2022
2023,Year,2023
2024,Year,2024

# Header row defines the base observation properties
Expenditure category,observationAbout,country/USA,measuredProperty,consumerPriceIndex,populationType,ConsumerGoodsAndServices
```

## Pattern H: Category Enumeration for Economic/Classification Data

When data has expenditure categories, economic classifications, or other enumerated types, each category value needs its own explicit mapping.

**Recognition Signals:**
- Column with many distinct category values (Energy, Food, Medical care, etc.)
- Categories represent classification hierarchies (CPI categories, industry codes)
- Values need mapping to specific DC property enums

**Example (CPI category data):**
```csv
key,prop,val,p1,v1,p2,v2,p3,v3
# Base observation setup
Expenditure category,observationAbout,country/USA,measuredProperty,consumerPriceIndex,populationType,ConsumerGoodsAndServices,consumer,UrbanWageEarnerAndClericalWorker,measurementMethod,BLSUnchained,unit,IndexPointBasePeriod1982_1984Equals100

# Measurement types (seasonally adjusted vs not)
Unadjusted indexes,measurementQualifier,BLSSeasonallyUnadjusted,value,{Number},observationPeriod,P1M
Seasonally adjusted indexes,measurementQualifier,BLSSeasonallyAdjusted,value,{Number},observationPeriod,P1M

# Category mappings - one per category value
Energy,consumerGoodsCategory,Energy
Energy services,consumerGoodsCategory,EnergyServices
Food,consumerGoodsCategory,Food
Food at home,consumerGoodsCategory,FoodAtHome
Medical care,consumerGoodsCategory,MedicalCare
Medical care commodities,consumerGoodsCategory,MedicalCareCommodities
Physicians' services,consumerGoodsCategory,PhysiciansServices
# ... continue for ALL category values (may be 50+)
```

**CRITICAL**: Each category value needs its own explicit mapping. Do NOT try to use `{Data}` for categories - they must be mapped to specific DC vocabulary enums.

---

# SPECIAL SYNTAX

## Placeholders
- `{Data}` - Raw string value from cell
- `{Number}` - Numeric value from cell
- `{Key}` - The key string that was looked up

## Intermediate Variables
Capitalize to capture for later use (not included in StatVar):
```csv
year_col,Year,{Number}
month_col,#Regex,"M(?P<Month>[0-9]+)"
value_col,observationDate,{Year}-{Month},value,{Number}
```

## #Format - Zero-pad Values
```csv
FIPS,#Format,"observationAbout=geoId/{Number:05d}"        # 1001 → geoId/01001
state_fips,#Format,"observationAbout=geoId/{Number:02d}"  # 6 → geoId/06
```

## #Regex - Extract with Named Groups
```csv
REF_AREA,#Regex,"^(?P<Code>[A-Z]+):.*",observationAbout,country/{Code}
```
**Must use named groups** `(?P<Name>...)` - unnamed groups don't work.

## #Eval - Python Expressions
```csv
Status,#Eval,"active='Yes' if '{Data}' == 'Y' else 'No'"
```
**Always quote {Data}** in expressions.

## #ignore - Drop Rows
```csv
Series ID,#ignore,skip
```
Drops entire row containing this value. To skip value only, use empty intermediate: `BadValue,Skip,''`

---

# PLACE FORMATS

| Format | Example | Use Case |
|--------|---------|----------|
| `country/{Data}` | `country/USA` | ISO-3 codes in data |
| `geoId/{Number:02d}` | `geoId/06` | US state FIPS |
| `geoId/{Number:05d}` | `geoId/01001` | US county FIPS |
| `wikidataId/QXXXXX` | `wikidataId/Q22424` | Non-US places |
| `Earth` | `Earth` | Global data |

⚠️ **Dynamic construction does NOT work**: `observationAbout,{Country}/{City}` fails.

**Use explicit mappings for place names:**
```csv
Country or Area:Åland Islands,observationAbout,country/AX
srcStateName:Punjab,observationAbout,wikidataId/Q22424
```

## Composite FIPS (state + county)
```csv
statefips,StateFips,{Data}
countyfips,#Format,"observationAbout=geoId/{StateFips}{Number:03d}"
```

## Complete US State Mapping Example

For datasets with US state names, you MUST map each state explicitly to its FIPS code. State names CANNOT be dynamically resolved.

```csv
key,p1,v1,p2,v2,p3,v3,p4,v4
# Header row with core StatVar properties
State or jurisdiction,observationDate,{Number},populationType,Person,measuredProperty,minimumWage,unit,USDollarPerHour

# Each state maps to its geoId FIPS code
Alabama,observationAbout,geoId/01,value,{Number}
Alaska,observationAbout,geoId/02,value,{Number}
Arizona,observationAbout,geoId/04,value,{Number}
Arkansas,observationAbout,geoId/05,value,{Number}
California,observationAbout,geoId/06,value,{Number}
Colorado,observationAbout,geoId/08,value,{Number}
Connecticut,observationAbout,geoId/09,value,{Number}
Delaware,observationAbout,geoId/10,value,{Number}
District of Columbia,observationAbout,geoId/11,value,{Number}
Florida,observationAbout,geoId/12,value,{Number}
Georgia,observationAbout,geoId/13,value,{Number}
Hawaii,observationAbout,geoId/15,value,{Number}
Idaho,observationAbout,geoId/16,value,{Number}
Illinois,observationAbout,geoId/17,value,{Number}
Indiana,observationAbout,geoId/18,value,{Number}
Iowa,observationAbout,geoId/19,value,{Number}
Kansas,observationAbout,geoId/20,value,{Number}
Kentucky,observationAbout,geoId/21,value,{Number}
Louisiana,observationAbout,geoId/22,value,{Number}
Maine,observationAbout,geoId/23,value,{Number}
Maryland,observationAbout,geoId/24,value,{Number}
Massachusetts,observationAbout,geoId/25,value,{Number}
Michigan,observationAbout,geoId/26,value,{Number}
Minnesota,observationAbout,geoId/27,value,{Number}
Mississippi,observationAbout,geoId/28,value,{Number}
Missouri,observationAbout,geoId/29,value,{Number}
Montana,observationAbout,geoId/30,value,{Number}
Nebraska,observationAbout,geoId/31,value,{Number}
Nevada,observationAbout,geoId/32,value,{Number}
New Hampshire,observationAbout,geoId/33,value,{Number}
New Jersey,observationAbout,geoId/34,value,{Number}
New Mexico,observationAbout,geoId/35,value,{Number}
New York,observationAbout,geoId/36,value,{Number}
North Carolina,observationAbout,geoId/37,value,{Number}
North Dakota,observationAbout,geoId/38,value,{Number}
Ohio,observationAbout,geoId/39,value,{Number}
Oklahoma,observationAbout,geoId/40,value,{Number}
Oregon,observationAbout,geoId/41,value,{Number}
Pennsylvania,observationAbout,geoId/42,value,{Number}
Rhode Island,observationAbout,geoId/44,value,{Number}
South Carolina,observationAbout,geoId/45,value,{Number}
South Dakota,observationAbout,geoId/46,value,{Number}
Tennessee,observationAbout,geoId/47,value,{Number}
Texas,observationAbout,geoId/48,value,{Number}
Utah,observationAbout,geoId/49,value,{Number}
Vermont,observationAbout,geoId/50,value,{Number}
Virginia,observationAbout,geoId/51,value,{Number}
Washington,observationAbout,geoId/53,value,{Number}
West Virginia,observationAbout,geoId/54,value,{Number}
Wisconsin,observationAbout,geoId/55,value,{Number}
Wyoming,observationAbout,geoId/56,value,{Number}

# US Territories
Guam,observationAbout,geoId/66,value,{Number}
Puerto Rico,observationAbout,geoId/72,value,{Number}
U.S. Virgin Islands,observationAbout,geoId/78,value,{Number}

# Federal level (for national data)
Federal (FLSA),observationAbout,country/USA,value,{Number}
```

**DO NOT** use `observationAbout,geoId/{Data}` for state names - state names cannot be dynamically resolved to FIPS codes.

---

# STATVAR PROPERTY VOCABULARY GUIDE

## Common Vocabulary Mistakes

| Wrong | Correct | Notes |
|-------|---------|-------|
| `measuredProperty: wages` | `measuredProperty: minimumWage` | Use specific property name |
| `populationType: Worker` | `populationType: Person` | Person is the standard population type |
| `populationType: Person` | `populationType: BirthEvent` | For birth counts, use event type not person |
| `measuredProperty: count` | (often implicit) | Don't add if already implied by statType |
| `wageType: MinimumWage` | (use measuredProperty) | Don't invent new properties, use measuredProperty directly |
| `exchangeRateType: X` | `measuredProperty: exchangeRate` | Use standard measured properties |

## Population Type Selection Guide

Choose the correct `populationType` based on what is being counted:

| Data Type | populationType | Example |
|-----------|---------------|---------|
| Human population counts | `Person` | Census data, demographics |
| Birth statistics | `BirthEvent` | Birth rates, births per year |
| Death statistics | `DeathEvent` | Mortality data |
| Family/housing data | `Household` | Housing surveys |
| Education data | `Student` | School enrollment, test scores |
| Employment (prefer) | `Person` + employment constraints | Unemployment rates |
| Currency/exchange | `Currency` | Exchange rate data |
| Price indices | `ConsumerGoodsAndServices` | CPI data |
| Crime statistics | `CriminalActivities` or specific type | Crime reports |
| Medical data | `MedicalConditionIncident` | Health surveys |

## When in Doubt About Property Names

1. **Check the schema examples provided** - they use correct vocabulary
2. **Use the most specific property available** - `minimumWage` not `wages`
3. **Prefer existing DC vocabulary over inventing new properties**
4. **Don't add redundant properties** - if statType implies count, don't add measuredProperty:count

---

# FIXED VALUES VS PLACEHOLDERS

## When to Use Fixed DCIDs (NOT placeholders)

Some data should map to fixed values, not `{Data}` placeholders:

### 1. Single-Country Datasets
If ALL data is about one country, use fixed DCID:
```csv
# ❌ Wrong - treats country as variable
country_col,observationAbout,{Data}

# ✅ Correct - fixed value for single-country data
country_col,observationAbout,country/BRA
```

### 2. Known Program/Type Identifiers
When the program or type is constant across the dataset:
```csv
# For Brazil Rural Development Program
program_col,benefitProgram,Brazil_RuralDevelopmentProgram,benefitType,FinancialBenefit
```

### 3. Fixed Observation Periods
When all data has the same time granularity:
```csv
# If all data is annual
Year,observationDate,{Data},observationPeriod,P1Y

# If all data is monthly
Month,observationDate,{Data},observationPeriod,P1M
```

### 4. Fixed Base Properties
When certain properties are constant for the entire dataset:
```csv
# CPI data always about USA, always same methodology
Expenditure category,observationAbout,country/USA,measurementMethod,BLSUnchained
```

## Recognition Signals for Fixed Values
- Column has identical values in all rows
- Dataset metadata indicates single country/region
- Program name or type is constant across dataset
- Data source documentation specifies fixed context

---

# CRITICAL RULES

1. **EVERY observation MUST have observationAbout** - This is the geographic/organizational unit being measured
   - Without it: Validation will fail with "Unable to resolve SVObs place" and produce 0 output rows
   - Common sources: Country columns, state columns, county codes, organization IDs
   - If no place column exists, check if data is about a single fixed location (e.g., country/USA)
   - **Test your PVMAP**: Search for "observationAbout" in your mappings - there MUST be at least one

2. **Keys must exactly match** input data (case-sensitive)
3. **Use exact Data Commons vocabulary** - Property names must match DC schema exactly
   - Check schema examples for correct property names
   - Common mistakes:
     - ❌ `benefitProgram` → ✅ `beneficiaryProgram`
     - ❌ `populationGroup` → ✅ `populationType`
     - ❌ `measurement` → ✅ `measuredProperty`
   - If unsure, reference the schema examples provided
4. **Quote keys with special chars**: commas, parentheses, quotes
5. **Every value column needs ALL properties**: `value,{Number}`, `populationType`, `measuredProperty`, `statType`
6. **>5-10 categorical values?** Use explicit mappings, not regex
7. **Place names require explicit DCID mappings** - no dynamic resolution

---

# KNOWN LIMITATIONS (require preprocessing)

- Carry-forward/sparse data (values not repeated per row)
- Multi-row headers / merged cells
- Footer/metadata rows after blank lines
- ISO-2 country codes (need conversion to ISO-3)

Non-numeric placeholders (`#`, `*`, `N/A`, `Unreliable`) are auto-skipped.

---

# COMMON MISTAKES

## Structure & Format Mistakes
1. Missing StatVar properties on value columns
2. Partial key matches (`AR` won't match `AR: Argentina`)
3. Wide data without complete properties per column
4. Dynamic place construction instead of explicit mappings
5. Single regex for 50+ codes instead of explicit list
6. Ignoring column then referencing it (`#ignore` + `{Year}`)
7. Missing observationAbout entirely (causes complete validation failure with 0 rows)
8. Mapping date/time columns instead of place columns to key observations

## Vocabulary & Property Mistakes
9. Using similar but incorrect property names (benefitProgram vs beneficiaryProgram)
10. Inventing new property names not in Data Commons vocabulary
11. **Wrong populationType**: Using `Worker` instead of `Person`, or `Person` instead of `BirthEvent`
12. **Wrong measuredProperty**: Using generic `wages` instead of specific `minimumWage`
13. **Adding redundant properties**: Adding `measuredProperty: count` when statType already implies it
14. **Inventing constraint properties**: Creating `wageType: MinimumWage` instead of using measuredProperty directly

## Passthrough & Detection Mistakes
15. **Using passthrough when data needs decomposition**: Just because columns are named variableMeasured/observationAbout doesn't mean passthrough is correct
16. **Passthrough with non-DCID variableMeasured**: Passthrough only works when variableMeasured contains `dcid:` prefixed DCIDs
17. **Missing categorical dimension mappings**: Data with 50+ categories needs explicit mappings for each

## Fixed Value Mistakes
18. **Treating constants as placeholders**: Using `{Data}` for single-country data instead of fixed `country/BRA`
19. **Missing fixed observation periods**: Not including `observationPeriod: P1Y` for annual data

---

# SCHEMA EXAMPLES

{{SCHEMA_EXAMPLES}}

---

# WORKED EXAMPLES FROM FAILED DATASETS

## Example 1: Missing observationAbout (FEMA Dataset)

**Input Data:**
```csv
State,Year,Disasters,TotalAmount
AL,2020,5,1234567
FL,2021,8,9876543
```

**Wrong PVMAP** (causes validation failure):
```csv
Year,observationDate,{Data}
Disasters,value,{Number},populationType,NaturalDisaster,measuredProperty,count,statType,measuredValue
```
**Error**: "Unable to resolve SVObs place" → 0 output rows

**Correct PVMAP:**
```csv
State,observationAbout,geoId/{StateCode}
State:AL,StateCode,01
State:FL,StateCode,12
Year,observationDate,{Data}
Disasters,value,{Number},populationType,NaturalDisaster,measuredProperty,count,statType,measuredValue
```

---

## Example 2: Pre-Formatted Data (Brazil Food Basket)

**Input Data:**
```csv
observationAbout,observationDate,variableMeasured,value
country/BRA,2020-01,dcid:CumulativeCount_FoodBasket_Delivered,1500
country/BRA,2020-02,dcid:CumulativeCount_FoodBasket_Delivered,1750
```

**Wrong PVMAP** (tries to reconstruct):
```csv
variableMeasured:dcid:CumulativeCount_FoodBasket_Delivered,populationType,FoodBasket,measuredProperty,cumulativeCount,statType,measuredValue,measurementMethod,Delivered
```
**Result**: 0% accuracy - completely wrong structure

**Correct PVMAP** (passthrough):
```csv
observationAbout,observationAbout,{Data}
observationDate,observationDate,{Data}
variableMeasured,variableMeasured,{Data}
value,value,{Number}
```

---

## Example 3: Missing Dimension Properties (School Retention)

**Input Data:**
```csv
State,Year,Gender,Race,Grade,Value
AL,2020,Male,White,9,95.5
AL,2020,Female,Black,9,93.2
```

**Wrong PVMAP** (ignores dimensions):
```csv
State,observationAbout,geoId/{StateCode}
Year,observationDate,{Data}
Value,value,{Number},populationType,Student,measuredProperty,retentionRate,statType,measuredValue
```
**Result**: 0% accuracy - missing all categorical dimensions

**Correct PVMAP:**
```csv
State,observationAbout,geoId/{StateCode}
Year,observationDate,{Data}
Value,value,{Number},populationType,Student,measuredProperty,retentionRate,statType,measuredValue

# Map dimension columns
Gender:Male,gender,Male
Gender:Female,gender,Female
Race:White,race,WhiteAlone
Race:Black,race,BlackOrAfricanAmericanAlone
Grade:9,schoolGradeLevel,Grade9
```

---

# INPUT DATA

{{SAMPLED_DATA}}

---

# PROCESSOR CONFIG

{{METADATA_CONFIG}}

---

# OUTPUT

Provide ONLY pvmap.csv content in a csv code block.

**CHECKLIST:**
- [ ] **Data format detected**: Is this pre-formatted DC data or raw data?
  - [ ] If pre-formatted (has variableMeasured column with DCIDs): Use passthrough mapping
  - [ ] If raw data: Construct full StatVar properties
- [ ] **observationAbout mapped**: MUST have at least one mapping for observationAbout
  - [ ] Identify location/entity column in input data
  - [ ] Map to correct DCID format (country/, geoId/, wikidataId/, Earth)
- [ ] **Keys exactly match input** (case-sensitive)
- [ ] **Special char keys double-quoted**
- [ ] **CSV formatting valid**:
  - [ ] No unescaped backslashes
  - [ ] Proper quote escaping
  - [ ] Parseable by Python csv.reader
- [ ] **Every value column has**:
  - [ ] `value,{Number}` (or appropriate placeholder)
  - [ ] `populationType`, `measuredProperty`, `statType` (if NOT pre-formatted data)
  - [ ] OR `variableMeasured,{Data}` (if pre-formatted data)
- [ ] **Dimension columns mapped**: If data has categorical splits (age, gender, race), map each value
- [ ] **observationDate format**: YYYY, YYYY-MM, or YYYY-MM-DD
- [ ] **observationAbout uses valid DCID** (geoId/, country/, wikidataId/, Earth)
- [ ] **No dynamic place construction** - explicit mappings only
- [ ] **#Regex uses named groups** `(?P<Name>...)`
- [ ] **Property names match DC vocabulary** - check schema examples
- [ ] Note any data limitations in response
